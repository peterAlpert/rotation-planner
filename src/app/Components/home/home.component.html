<div class="row m-3 p-3" dir="rtl">
    <!-- ุงูุนููุฏ ุงููููู: ุงููุดุฑููู + ุงูููุชุฑูู -->
    <div class="col-3">
        <h4 class="text-center">๐จโ๐ผ ุงููุดุฑููู</h4>
        <div cdkDropList id="supervisors" [cdkDropListData]="supervisors"
            [cdkDropListConnectedTo]="connectedSupervisorLists" (cdkDropListDropped)="drop($event)" class="list">
            <div class="row">
                <div class="col-6" *ngFor="let sup of supervisors" cdkDrag (cdkDragStarted)="onDragStarted()"
                    (cdkDragEnded)="onDragEnded()">
                    <div class="item supervisor text-center">{{ sup.name }}</div>
                </div>
            </div>
        </div>

        <h4 class="text-center mt-4">๐ฏ ุงูููุชุฑูู</h4>
        <div cdkDropList id="controllers" [cdkDropListData]="controllers"
            [cdkDropListConnectedTo]="connectedControllerLists" (cdkDropListDropped)="drop($event)" class="list">
            <div class="row">
                <div class="col-6" *ngFor="let ctrl of controllers" cdkDrag (cdkDragStarted)="onDragStarted()"
                    (cdkDragEnded)="onDragEnded()">
                    <div class="item controller text-center">{{ ctrl.name }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ุงูุนููุฏ ุงูุดูุงู: ุงูููุงุทู (ูุงุจู ููุชูุฑูุฑ) -->
    <div class="col-9 areas-scroll" #areasContainer>
        <div class="row">
            <div class="col-md-6 mb-4" *ngFor="let area of areas">
                <div class="area-card p-3 h-100 d-flex flex-column" [style.borderColor]="area.color">
                    <h1 class="fw-bold text-center mb-3 text-light">{{ area.name }}</h1>

                    <!-- ูู ุงูููุทูุฉ ุดููุช ุตุจุงุญู -->
                    <ng-container *ngIf="area.name === 'ุดููุช ุตุจุงุญู'; else normalArea">
                        <!-- ุงููุดุฑู -->
                        <h4 class="fw-bold text-center mb-3" [style.color]="area.color">
                            ๐จโ๐ผ
                            <span *ngIf="area.supervisors.length > 0" class="fs-1">
                                {{ area.supervisors[0].name }}
                                <span class="remove-btn"
                                    (click)="removePerson(area.supervisors[0], area, 'supervisor')">ร</span>
                            </span>
                            <div *ngIf="area.supervisors.length === 0" class="empty-box list" cdkDropList
                                [id]="area.name + '-sup'" [cdkDropListData]="area.supervisors"
                                [cdkDropListConnectedTo]="connectedSupervisorLists" (cdkDropListDropped)="drop($event)">
                                ุงุณุญุจ ูุดุฑู ููุง
                            </div>
                        </h4>

                        <!-- ุงูุดูุชุงุช -->
                        <div *ngFor="let shift of area.shifts" class="shift-box mb-3">
                            <h5 class="text-center text-light">{{ shift.name }}</h5>
                            <div class="row">
                                <!-- ุตุจุงุญู -->
                                <div class="col-6">
                                    <h6 class="text-center text-warning">ุตุจุงุญู</h6>
                                    <div cdkDropList [id]="shift.name + '-sabahy'" [cdkDropListData]="shift.sabahy"
                                        [cdkDropListConnectedTo]="connectedControllerLists"
                                        (cdkDropListDropped)="drop($event)" class="list">
                                        <div *ngFor="let ctrl of shift.sabahy" cdkDrag
                                            (cdkDragStarted)="onDragStarted()" (cdkDragEnded)="onDragEnded()"
                                            class="item controller text-center">
                                            {{ ctrl.name }}
                                            <span class="remove-btn"
                                                (click)="removePerson(ctrl, area, 'controller')">ร</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Between -->
                                <div class="col-6">
                                    <h6 class="text-center text-info">ุจูุชููู</h6>
                                    <div cdkDropList [id]="shift.name + '-between'" [cdkDropListData]="shift.between"
                                        [cdkDropListConnectedTo]="connectedControllerLists"
                                        (cdkDropListDropped)="drop($event)" class="list">
                                        <div *ngFor="let ctrl of shift.between" cdkDrag
                                            (cdkDragStarted)="onDragStarted()" (cdkDragEnded)="onDragEnded()"
                                            class="item controller text-center">
                                            {{ ctrl.name }}
                                            <span class="remove-btn"
                                                (click)="removePerson(ctrl, area, 'controller')">ร</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </ng-container>

                    <!-- ุจุงูู ุงูููุงุทู -->
                    <ng-template #normalArea>
                        <!-- ุงููุดุฑู -->
                        <h4 class="fw-bold text-center mb-3" [style.color]="area.color">
                            ๐จโ๐ผ
                            <span *ngIf="area.supervisors.length > 0" class="fs-1">
                                {{ area.supervisors[0].name }}
                                <span class="remove-btn"
                                    (click)="removePerson(area.supervisors[0], area, 'supervisor')">ร</span>
                            </span>
                            <div *ngIf="area.supervisors.length === 0" class="empty-box list" cdkDropList
                                [id]="area.name + '-sup'" [cdkDropListData]="area.supervisors"
                                [cdkDropListConnectedTo]="connectedSupervisorLists" (cdkDropListDropped)="drop($event)">
                                ุงุณุญุจ ูุดุฑู ููุง
                            </div>
                        </h4>

                        <!-- ุงูููุชุฑูู -->
                        <h6 class="text-light text-center mt-3">๐ฏ ุงูููุชุฑูู ({{ area.controllers.length }})</h6>
                        <div cdkDropList [id]="area.name + '-ctrl'" [cdkDropListData]="area.controllers"
                            [cdkDropListConnectedTo]="connectedControllerLists" (cdkDropListDropped)="drop($event)"
                            class="list controllers-box">
                            <div *ngFor="let ctrl of area.controllers" cdkDrag (cdkDragStarted)="onDragStarted()"
                                (cdkDragEnded)="onDragEnded()" class="item controller text-center person controller">
                                {{ ctrl.name }}
                                <span class="remove-btn" (click)="removePerson(ctrl, area, 'controller')">ร</span>
                            </div>
                        </div>
                    </ng-template>
                </div>
            </div>
        </div>
    </div>

    <div class="fixed-buttons text-center">
        <button class="btn btn-success" (click)="saveDistribution()">๐พ ุญูุธ</button>
        <button class="btn btn-info" (click)="loadDistribution()">๐ ุชุญููู</button>
        <button class="btn btn-warning" (click)="resetDistribution()">โป๏ธ ุฅุนุงุฏุฉ</button>
        <button class="btn btn-success" (click)="exportToWord()">๐ฅ ุชุตุฏูุฑ Word</button>
    </div>
</div>